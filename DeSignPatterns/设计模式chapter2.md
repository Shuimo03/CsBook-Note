# 设计模式chapter2

## 实践案例-Lexi文档编辑器

### 设计问题

1. 文档结构
2. 格式化
3. 修饰用户界面
4. 支持多种视感标准
5. 支持多种窗口系统
6. 用户操作
7. 拼写检查和连字符

支持多种窗口系统有点类似于自适应，不同的屏幕尺寸显示不同的样子。

### 文档结构

文档的逻辑结构是句子、段落、节、小节和章，文档结构的内部如下几点

- 保持文档的物理结构，即将文本和图形安排到行，列，表等。
- 可视化地生成和显示文档。
- 根据显示位置来映射文档内部表示的元素。

### 递归组合

层次结构的信息表达通常是使用递归组合来实现，递归组合可以通过比较简单的元素逐渐建立起复杂的元素，每一个重要的元素可以表示成一个对象，就可以描述这种物理结构，不仅包括可见元素，还包括不可见元素。

### 使用递归组合的例子和好处

假设一个购物系统，下单买东西就会产生订单，订单中有各种各样的信息，比如包含无包装的简单产品，也可以是包含装满产品的盒子，如果要计算每张订单中的总价格的话，可以通过打开所有的盒子，然后找到里面所有的产品，最后计算出总价，现实生活中可以这样做，但是在写代码的时候，不能简单的去使用循环语句来完成这些工作，必须事先晓得所有的产品和盒子，以及这些信息，所以直接计算不方便。

这里就可以使用递归组合来解决这个问题，通过一个通用接口，然后让产品和盒子进行交互，并且在该接口中声明一个计算总价的方法(函数)。

对于一个产品，方法可以设计成直接返回价格，对于一个盒子，这个方法就遍历盒子中所有的产品，然后询问每个产品的价格，最后返回这个盒子的总价格，这样做的好处在于可以把具体类想象成一棵树，然后递归遍历这棵树，不需要去了解这棵树的形状，也不需要了解对象是简单的产品还是复杂的盒子，需要调用通用接口就可以使用相同的方式进行处理。

也是第一章提到的针对接口编程。

## 组合模式

组合模式的结构如下

1. 组件：接口描述树中简单项目和复杂项目的所共有的操作
2. 叶节点：是树的基本结构，不包含子项目，一般情况下
3. 容器/组合：是包含叶节点或者其他容器等子项目的单位，容器不知道其子项目所属的具体类，只通过通用的组件接口与子项目交互。
4. 客户端：通过组件接口和所有项目交互，所以客户端能以相同的方式与树状结构中的简单或复杂项目交互。

## 格式化



### 封装格式化算法

