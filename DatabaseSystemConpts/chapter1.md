## 数据库组成

数据库是由一个互相关联的数据集合和一组能够访问这些数据的程序组成，所以数据库又被称为数据管理系统(DBMS)。

## 数据库的应用场景

- 企业信息
  - 销售：用于存储用户，产品和购买信息。
  - 会计：用户存储付款、收据、账户余额、资产和其他会计信息。
  - .....
- 银行金融
  - 银行业：用于存储用户信息，账户信息，贷款，以及银行的交易信息。
  - 银行卡和信用卡：消费记录，开卡用户信息。
  - 金融业：用于存储股票、债卷等金融票据的持有，出售和买入的信息；也可以用于存储实时的市场数据。
- 大学：用于存储学生信息等，课程注册和成绩。
- 航空业：用于存储订票和航班信息。
- 电信业：用于存储通话记录，产生每月账单，维护预付电话卡的余额和存储通信网络的信息。

## 文件处理系统

文件系统使用文件和树形目录的抽象逻辑概念代替硬盘和光盘等物理设备使用数据块的概念，用户不需要关系数据实际保存在硬盘或光盘的地址为多少的数据块上，只需要记住这个文件的所属目录和文件名。

### 文件处理系统的主要弊端

- 数据的冗余和不一致
- 数据访问困难
- 数据孤立
- 完整性问题
- 原子性问题
- 并发访问异常
- 完全性问题

### 数据的冗余和不一致

因为文件和程序是在很长一段时间内由不同的程序员所创建的，不同文件可能有不同的结构，不同的程序由不同的程序语言实现，除此之外，可能相同的信息在好几个地方重复存储，从而导致存储和访问开销增大，还会导致数据不一致性，所谓数值不一致性，是指统一数据的不同副本不一致。

### 数据访问困难

假设某个大学的办事人员，需要找出某学生信息，于是他就需要去找关于这个学校所在分院的文件夹，然后在分院文件夹中，继续寻找专业班级等文件夹，最后找到这个学生的信息，所以传统的文件处理环境不支持以一种高效的方式去获得所得到的数据。

### 数据孤立

由于数据分散在不同的文件中，这些文件又具有不同的格式，所以编写新的应用程序来检索当数据是很困难的。

### 完整性问题

数据库中所存储数据的值必须满足某些特定的一致性约束，假设大学为每一个系统维护账户，并且记录在各个账号的余额，还假设大学要求每个系的账户余额永远不能低于零。

### 原子性问题

对于很多应用来说，如果计算机发生故障，数据应该恢复到故障之前的一致状态，假设支付宝转账，A转账给B，B接受A的转账，这个时候支付系统发生变故，这个时候可能会发生这种情况，A的账户余额已经扣了500，而B没有收到，就造成了数据库状态不一致性，所以为了保证数据的一致性，入账和转账都发生，要不都没发生，这就是原子性。

### 并发访问异常

并发可以提升系统的总体性能，许多系统允许多个用户同时更新信息，在这种情况下，并发的更新操作可能会相互不一样，从而导致信息不一致，假设一个商品设为500块钱，这个时候顾客下单，而商品改价格，两个操作几乎同时发生，这样的情况就会引发并发执行一种错误。

### 完全性问题

数据库并不是所有的用户访问权限都是一样的，比如说银行的普通用户只能对自己银行卡进行操作，不能做一些越界操作，比如自己注销卡，或者修改卡的编码。

## 数据视图

因为数据库是一个由互相关联的数据以及一组使得用户可以访问和修改这些数据的程序集合，所以数据库系统一个主要目的是给用户提供数据的抽象试图，换句话来说，就是系统隐藏关于数据存储和维护的某些细节。

### 数据抽象

数据抽象是系统开发人员为了降低用户的操作性，从而提升用户体验，所以数据抽象分为如下几层

- 物理层：最低层次抽象，描述数据如何存储，物理层详细描述了复杂的底层数据结构。
- 逻辑层：相比物理层又提高了一些抽象，描述数据在数据库中是什么关系。
- 视图层：最高层次的抽象，只描述整个数据库的某个部分，虽然还有一些复杂性，但是用户已经可以使用。

### 实例和模式

随着数据库中的操作，数据库中很多信息会发生改变，特定时刻存储在数据库中的信息集合称为数据库的一个实例，而数据库的总体设计被称为数据库模式，根据不同的抽象层次，数据库系统也可以被分为不同的模式

- 物理模式：在物理层描述数据库的设计
- 逻辑模式：在逻辑层描述数据库的设计
- 子模式：描述数据库的不同试图

### 数据模型

- 关系模型
- 实体-联系模型
- 基于对象的数据模型
- 半结构化数据模型
- 网状数据模型
- 层次数据模型

### 关系模型

### 实体-联系模型

### 基于对象的数据模型

### 半结构化数据模型

### 网状数据模型

### 层次数据模型

## 数据库语言

数据库系统提供数据定义语言来定义数据库模式，以及数据操纵语言来表达数据库的更新和查询，SQL就是由这两种语言组成。

### 数据操纵语言(DML)

DML是让用户可以访问或者操纵那些按照某种的数据模型组织起来的数据类型，有如下访问类型

1. 对存储在数据库中的信息进行检索。
2. 向数据库中插入新的信息。
3. 从数据库中删除信息。
4. 修改数据库中存储的信息。

### DML分类

- 过程化DML：要求用户指定需要说明数据以及如何获得这些数据。
- 声明化DML：只要求用户指定需要什么数据，而不需要指明如何获得这些数据。

在DML中涉及信息检索的部分被称为查询语言，而查询是要求对信息进行检索的语句。

### 数据定义语言

数据库是通过一系列定义来说明的，这些定义由一种数据定义语言(DDL)的特殊语言来表达，所以DDL也可以用于定义数据的其他特征，数据库系统所使用的存储结构和访问方式是通过一系列特殊的DDL语句来说明，这种特殊的DDL被称为数据存储和定义语言。

存储在数据库中的数据值必须满足某些一致性约束。

### 一致性约束

### 完整性约束

- 域约束：每个属性都必须对应一个所有可能的取值构成，声明一种属性属于某种具体的域就相当于约束它的值。
- 参照完整性
- 断言
- 授权
  - 读权限
  - 插入权限
  - 更新权限
  - 删除权限

## 关系数据库

关系数据库基于关系模型，使用一系列表来表示数据之间的关系，关系数据库也包括了DML和DDL，关系模型是基于记录的模型的一个实例，是因为数据库的结构是集中固定的记录。

### 表

表由列和行做出，一个表可以有很多列，但是每个列只能有一个列名，每个表包含一种特定类型的记录，每种记录定义固定数目的字段或属性，表的列对应记录类型的数学。

### 数据操纵语言

SQL语言是非过程化的，以几个表作为输入或者一个表作为输入，但是只会返回一个表作为结果。

## ODBC

## 设计过程

- 概念设计
- 功能需求说明
- 逻辑设计阶段
- 物理设计阶段

### 规范化

## 数据存储和查询

数据库系统被划分为不同的模块，每个模块完成整个系统的一个功能，数据库系统的功能部件大致被分为存储管理器和查询处理部件。

### 存储管理器

存储管理器在数据库系统中负责和数据库中底层数据与应用程序以及向系统提交的查询之间提供接口的部件，存储管理器将各种DML语句翻译成底层文件系统命令，所以存储管理器负责数据库中数据库的存储、检索和更新。

存储管理部件如下

- 权限以及完整性管理器
- 事物管理器
- 文件管理器
- 缓冲区管理器
- 数据文件
- 数据字典
- 索引

### 查询处理器

- DDL解释器
- DML编译器
- 查询执行引擎

### 事务管理

- 原子性
- 一致性
- 持久性

事务时数据库应用中完成单一逻辑功能的操作集合，每一个事务都是具有原子性和一致性的单元。

### 恢复管理器

### 并发控制管理器

